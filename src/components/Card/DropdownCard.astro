---
import { Icon } from "astro-icon/components";

interface Props {
  title?: string;
  body?: string;
  colSpan?: string;
  rowSpan?: string;
  href?: string;
  colorText?: string;
  height?: string;
  width?: string;
  borderColor?: string;
  class?: string;
}

const {
  title,
  body,
  colSpan,
  rowSpan,
  href,
  colorText,
  height,
  borderColor,
  class: classNames,
} = Astro.props;
---

<style>
  .hide-content {
    display: none;
  }
</style>

<script>
  // TODO: write logic for plopping open the content and hiding it again on focus & focusend
  const dropdownCards = document.querySelectorAll(".dropdown-card");
  dropdownCards.forEach((dropdownCard) => {
    const icon = dropdownCard.querySelector("svg.the-icon");
    const contentToHide = dropdownCard.querySelector("div.content-to-hide");

    dropdownCard.addEventListener("focus", (event) => {
      if (icon) {
        icon.classList.add("rotate-180");
      }
      if (contentToHide) {
        contentToHide.classList.remove("hide-content");
      }
    });
    dropdownCard.addEventListener("focusout", () => {
      if (icon) {
        icon.classList.remove("rotate-180");
      }
      if (contentToHide) {
        contentToHide.classList.add("hide-content");
      }
    });
  });
</script>

<div
  tabindex="0"
  class={`card dropdown-card group overflow-hidden transform-y-[-40%] bg-darkslate-500 shadow-lg rounded-lg p-6 border ${borderColor ? borderColor : "border-darkslate-100"} hover:border-primary-500 align-start flex-none ${height} justify-start relative transform perspective-1200 w-full transition duration-75 ease-in-out col-span-1 ${
    colSpan || "md:col-span-2"
  } ${rowSpan || ""} ${classNames}`}
>
  <a href={href} class={`${colorText || " "}`}>
    <Icon
      name="ri:arrow-up-s-line"
      class="the-icon h-6 float-right group-hover:text-primary-500 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform ease-in-out duration-500 z-20"
    />
    <h2 class="text-xl font-bold m-0 z-20">{title}</h2>
    <p class="m-0 font-light text-base">{body}</p>
    <div class="content-to-hide hide-content transition-all duration-500">
      <slot />
    </div>
  </a>
</div>
